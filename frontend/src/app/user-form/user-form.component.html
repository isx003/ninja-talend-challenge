<div class="container">
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <div class="card my-5">
                <div class="card-header">
                    <h5>{{ userId === undefined ? 'CREATE' : 'UPDATE' }} USER</h5>
                </div>
                <div class="card-body">
                    <form
                        [formGroup]="form"
                        #localForm="ngForm"
                        (ngSubmit)="onSubmit()">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="firstname" class="form-label">FIRSNAME</label>
                                    <input
                                        [readonly]="processing"
                                        type="text"
                                        class="form-control"
                                        formControlName="firstname"
                                        [class.is-invalid]="localForm.submitted && form.get('firstname')?.invalid"
                                    >
                                    <div class="invalid-feedback">
                                        Firstname is required and must be letters only
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="lastname" class="form-label">LASTNAME</label>
                                    <input
                                        [readonly]="processing"
                                        type="text"
                                        class="form-control"
                                        formControlName="lastname"
                                        [class.is-invalid]="localForm.submitted && form.get('lastname')?.invalid"
                                    >
                                    <div class="invalid-feedback">
                                        Lastname is required and must be letters only
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-7">
                                <div class="mb-3">
                                    <label for="email" class="form-label">EMAIL</label>
                                    <input
                                        [readonly]="processing"
                                        type="email"
                                        class="form-control"
                                        formControlName="email"
                                        [class.is-invalid]="localForm.submitted && form.get('email')?.invalid"
                                    >
                                    <div class="invalid-feedback">
                                        Email is required and must be with correct format
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-5">
                                <div class="mb-3">
                                    <label for="birth-date" class="form-label">BIRTH DATE</label>
                                    <div class="input-group">
                                        <input class="form-control"
                                            placeholder="yyyy-mm-dd"
                                            ngbDatepicker
                                            #d="ngbDatepicker"
                                            [minDate]="{year: 1930, month: 1, day: 1}"
                                            [maxDate]="{year: currentYear, month: currentMonth, day: currentDay}"
                                            readonly
                                            formControlName="birthDate"
                                            [class.is-invalid]="localForm.submitted && form.get('birthDate')?.invalid"
                                        >
                                        <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-check-fill" viewBox="0 0 16 16">
                                                <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4V.5zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2zm-5.146-5.146-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708z"/>
                                            </svg>
                                        </button>
                                        <div class="invalid-feedback">
                                            Birthdate is required
                                        </div>
                                      </div>
                                </div>
                            </div>

                            <div class="col-12">
                                <hr>
                                <h6>ADDRESS</h6>
                            </div>

                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label class="form-label">STREET</label>
                                    <input
                                        [readonly]="processing"
                                        type="text"
                                        class="form-control"
                                        formControlName="street"
                                        [class.is-invalid]="localForm.submitted && form.get('street')?.invalid"
                                    >
                                    <div class="invalid-feedback">
                                        Street is required and alphanumeric
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="text" class="form-label">CITY</label>
                                    <input
                                        [readonly]="processing"
                                        type="text"
                                        class="form-control"
                                        formControlName="city"
                                        [class.is-invalid]="localForm.submitted && form.get('city')?.invalid"
                                    >
                                    <div class="invalid-feedback">
                                        City is required and must be letters only
                                    </div>
                                </div>
                            </div>

                            <div class="col-8">
                                <div class="mb-3">
                                    <label for="text" class="form-label">COUNTRY</label>
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input
                                                    class="form-check-input"
                                                    type="radio"
                                                    name="country"
                                                    value="ES"
                                                    formControlName="country"
                                                    [class.is-invalid]="localForm.submitted && form.get('country')?.invalid"
                                                >
                                                <label class="form-check-label">
                                                    ES
                                                </label>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input
                                                    class="form-check-input"
                                                    type="radio"
                                                    name="country"
                                                    value="UK"
                                                    formControlName="country"
                                                    [class.is-invalid]="localForm.submitted && form.get('country')?.invalid"
                                                >
                                                <label class="form-check-label">
                                                    UK
                                                </label>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input
                                                    class="form-check-input"
                                                    type="radio"
                                                    name="country"
                                                    value="DE"
                                                    formControlName="country"
                                                    [class.is-invalid]="localForm.submitted && form.get('country')?.invalid"
                                                >
                                                <label class="form-check-label">
                                                    DE
                                                </label>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input
                                                    class="form-check-input"
                                                    type="radio"
                                                    name="country"
                                                    value="US"
                                                    formControlName="country"
                                                    [class.is-invalid]="localForm.submitted && form.get('country')?.invalid"
                                                >
                                                <label class="form-check-label">
                                                    US
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-4">
                                <div class="mb-3">
                                    <label for="text" class="form-label">POSTAL CODE</label>
                                    <input
                                        [readonly]="processing"
                                        type="text"
                                        class="form-control"formControlName="postalcode"
                                        [class.is-invalid]="localForm.submitted && form.get('postalcode')?.invalid"
                                        >
                                    <div class="invalid-feedback">
                                        Postal is required and must be numbers only
                                    </div>
                                </div>
                            </div>

                            <div class="col-6">
                                <div class="d-grid">
                                    <a routerLink="/users"
                                      class="btn btn-danger btn-sm"
                                      >CANCEL</a>
                                  </div>
                            </div>

                            <div class="col-6">
                                <div class="d-grid">
                                    <button type="submit"
                                      class="btn btn-success btn-sm"
                                      [disabled]="processing"
                                      >{{ processing ? 'PROCESSING' : 'SAVE' }}</button>
                                  </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<swal
    #successSwal
    title="Proccess done!"
    icon="success"
    [allowOutsideClick]="false"
    (confirm)="goToUsers()"></swal>

<swal
    #erroSwal
    title="{{errorMessage}}"
    icon="error"
></swal>
